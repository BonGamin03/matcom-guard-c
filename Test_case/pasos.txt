Para hacer que el directorio simulado (`/tmp/usb_test_mount`) aparezca como una **USB virtual** en tu máquina virtual de **Ubuntu (VirtualBox)**, necesitas compartir la carpeta entre el host y la VM como si fuera un dispositivo USB. Aquí te explico cómo hacerlo:

---

### **Solución: Compartir la carpeta como "USB virtual" en VirtualBox**

#### **1. Configuración en VirtualBox**
1. **Apaga** tu máquina virtual de Ubuntu (si está encendida).  
2. Abre **VirtualBox** y selecciona tu VM.  
3. Ve a **Configuración** → **USB**.  
   - Habilita **Controlador USB 3.0 (xHCI)** (recomendado para mejor compatibilidad).  
4. Ve a **Configuración** → **Carpetas compartidas**.  
   - Haz clic en el icono **"+"** para agregar una nueva carpeta compartida.  
   - **Ruta de la carpeta:** Selecciona `/tmp/usb_test_mount` (la que crea tu script).  
   - **Nombre:** Ponle un nombre (ej: `USB_VIRTUAL`).  
   - Marca **"Auto-montar"** y **"Hacer permanente"**.  
   - **Tipo de acceso:** "Completo" (para permitir lecturas y escrituras).  

---

#### **2. Montar manualmente en Ubuntu (si no se auto-monta)**
Si no se monta automáticamente, hazlo manualmente dentro de la VM:  
```bash
sudo mkdir -p /media/usb_virtual  # Directorio de montaje
sudo mount -t vboxsf USB_VIRTUAL /media/usb_virtual  # Montar la carpeta compartida
```

#### **3. Verificar que funciona**
- Ejecuta tu script en el **host** (anfitrión):  
  ```bash
  ./test_usb.sh
  ```
- Dentro de la VM, revisa el contenido:  
  ```bash
  ls /media/usb_virtual
  ```
  Deberías ver los archivos generados (`malware_samples/`, `normal_files/`, etc.).

---

### **Alternativa: USB real virtualizado (opcional)**
Si prefieres simular un **dispositivo USB físico** (más realista pero complejo):  
1. **Crea un archivo de imagen de USB virtual**:  
   ```bash
   dd if=/dev/zero of=virtual_usb.img bs=1M count=1024  # 1GB de tamaño
   mkfs.vfat virtual_usb.img  # Formatear como FAT32
   ```
2. **Monta la imagen en el host**:  
   ```bash
   sudo mkdir -p /mnt/virtual_usb
   sudo mount -o loop virtual_usb.img /mnt/virtual_usb
   ```
3. **Ejecuta tu script** apuntando a `/mnt/virtual_usb`.  
4. **En VirtualBox**:  
   - Ve a **Configuración** → **USB** → **Filtros**.  
   - Agrega un filtro para el dispositivo USB virtual (aparecerá cuando lo conectes).  

---

### **Notas importantes**
- **Permisos:** Asegúrate de que el usuario de la VM tenga permisos para acceder a la carpeta compartida.  
- **Sincronización:** Los cambios en `/tmp/usb_test_mount` (host) se reflejarán en tiempo real en la VM.  
- **Alternativa rápida:** Si solo necesitas probar el script en Ubuntu, ejecútalo directamente dentro de la VM (sin VirtualBox).  

Si tienes problemas, comparte el mensaje de error y verificamos la configuración.